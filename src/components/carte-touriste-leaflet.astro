---
import "leaflet/dist/leaflet.css";
---

<div id="map" style="height: 600px;"></div>

<script>
  import L from "leaflet";
  import tourismesMetropole from "../../public/tourismesMetropole.json";

  // Création de la carte centrée sur la France
  const map = L.map("map").setView([46.6033, 1.883], 6);

  // Fond OpenStreetMap
  L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png", {
    attribution: "© OpenStreetMap contributors"
  }).addTo(map);

  // Conversion des données JSON en GeoJSON
  const geojson = {
    type: "FeatureCollection",
    features: tourismesMetropole.map((d) => ({
      type: "Feature",
      geometry: {
        type: "Point",
        coordinates: [d.Longitude, d.Latitude] 
      },
      properties: {
        nom: d.Nom ?? "Inconnu"
      }
    }))
  };

  // Ajout des points sur la carte
  const layer = L.geoJSON(geojson, {
    pointToLayer: (feature, latlng) =>
      L.circleMarker(latlng, {
        radius: 1,
        fillColor: "#54278f", 
        color: "#54278f",
        weight: 0.5,
        fillOpacity: 0.8,
        opacity: 0.8
      }),
    onEachFeature: (feature, layer) => {
      layer.bindPopup(`<b>${feature.properties.nom}</b>`);
    }
  }).addTo(map);

  // Ajustement automatique du zoom
  map.fitBounds(layer.getBounds(), { maxZoom: 8 });
</script>
